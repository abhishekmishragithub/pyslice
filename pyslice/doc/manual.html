<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">

<HEAD>
<TITLE>pyslice User Manual</TITLE>
<META NAME="title" CONTENT="pyslice User Manual">
<META NAME="subject" CONTENT="">
<META NAME="description" CONTENT="">
<META NAME="creator" CONTENT="Tim Cera">
<META NAME="owner" CONTENT="">
<META NAME="date" CONTENT="2005-03-06">
<META NAME="validuntil" CONTENT="2005-12-31">
<META NAME="robots" CONTENT="none">
</HEAD>
<BODY BGCOLOR="#ffffff" TEXT="#000000"  LINK="#0000ff" VLINK="#990099" ALINK="#FF0000">
<TABLE WIDTH=800>
<TR>
<TD VALIGN="TOP" WIDTH=100>&nbsp;</TD>
<TD VALIGN="TOP" WIDTH=600><P ALIGN=CENTER><table width="100%"><tr><td><A href="http://pyslice.sourceforge.net">Pyslice</A></td><td><A href="http://sourceforge.net"> <IMG align="right" src="http://sourceforge.net/sflogo.php?group_id=33368" width="88" height="31" border="0" alt="SourceForge Logo"></td></tr></table></A></P><P ALIGN=CENTER><FONT SIZE=6>pyslice User Manual</FONT></P><P ALIGN=CENTER></P></TD>
<TD VALIGN="TOP" WIDTH=100>&nbsp;</TD>
</TR>
<TR>
<TD VALIGN="TOP" WIDTH=100></TD>
<TD VALIGN="TOP" WIDTH=600>
<H1><A NAME="#toc">Table of Contents</A></H1>
<UL>
<LI><A HREF="#1."> 1. Overview</A>
<LI><A HREF="#2."> 2. Tutorial</A>
<UL>
<LI><A HREF="#2.1."> 2.1. pyslice.conf</A>
<LI><A HREF="#2.2."> 2.2. Templates</A>
<LI><A HREF="#2.3."> 2.3. Tips and Tricks</A>
 </UL>
<LI><A HREF="#3."> 3. Mini Python Reference</A>
<UL>
<LI><A HREF="#3.1."> 3.1. Format</A>
 </UL>
<LI><A HREF="#4."> 4. Users Manual Disclaimer</A>
 </UL><p>

<H1><A NAME="1.">1. Overview</A></H1>
Pyslice creates input data sets from a template, replacing variables in the template files with a set of values.  It then runs the desired model against each created data set, keeping simultaneous model runs below a specified threshold or submitting jobs to a seperate queueing software.  It is an ideal program when hundreds of runs are required. Example uses would be for calibration or sensitivity analysis.  The input data set creation feature can easily be setup to create thousands of data sets.

<H1><A NAME="2.">2. Tutorial</A></H1>
See the example directory under the pyslice install directory for an example pyslice.conf, template_path, and output_path diretories.  To run the example, execute the 'go' script.

<H2><A NAME="2.1.">2.1. pyslice.conf</A></H2>
Pyslice requires a configuration file named 'pyslice.conf'.  Sections are identified with square brackets.  Parameters are set within each section with the format 'parameter=value'.  There are three required sections, 'paths', 'flags', and 'program'.  There must be at least one variable section.
<p>
The following example pyslice.conf will take all files in the template_path directory, replacing the variables 'flow', 'function', 'pressure', and 'salinity' within each file.  Note that the set does not included the stop value.

<PRE>

    [paths]
    # 'template_path' can contain any number of files.  Pyslice even
    #                 correctly handles binary files (just copies them)
    #                 and permissions.
    template_path=/path/to/directory/holding/the/template/datasets
    output_path=/path/to/where/output/directories/will/be/made

    # [flags] identify global options
    # 'keyword' can be changed if '$$' means something in your datasets
    # 'max_processes' should be set to 0 if you just want all the jobs
    #                 to be run.  This is useful if you have seperate
    #                 queueing software.  Otherwise set to the number
    #                 of simultaneous model runs you can allow on your
    #                 machine.
    # 'flat_dirs' gives the option of whether or not to have numbered
    #             output directories or a directory tree using the variable
    #             values.
    [flags]
    keyword=&quot;$$&quot;
    max_processes=8
    flat_dirs=&quot;N&quot;

    # [program] is the command you want run in each of the output 
    #           directories.
    [program]
    program=&quot;model -f &quot;

    # [flow] is set to 90, 92, 94, 96, 98
    # 'arithmetic' is (increment + previous_value) 
    [flow]
    type=arithmetic
    start=90
    stop=100
    increment=2

    # [function] is set to 5, 10, 20, 40
    # 'geometric' is (increment * previous_value)
    [function]
    type=geometric
    start=5
    stop=41
    increment=2

    # [pressure] is set to 1, 20, 24, 5, 8
    # 'list' takes the values in turn
    # 'value_type' can be int, float, or str
    # 'value####' must be the type in 'value_type'
    [pressure]
    type=list
    value_type=int
    value1=1
    value2=20
    value3=24
    value4=5
    value5=8

    # [rstage] is set to 'samples' values taken from distribution
    # 'distribution' is the statistical distribution from the random module
    #     uniform(a, b) - Get a random number in the range [a, b).
    #     randint(a, b) - Return random integer in range [a, b], including both end points.
    #     betavariate(alpha, beta) - Beta distribution.  Conditions on the parameters are alpha &gt; -1 and beta} &gt; -1.  Returned values range between 0 and 1.
    #     choice(seq) -  Choose a random element from a non-empty sequence.
    #     expovariate(lambd) - Exponential distribution.  lambd is 1.0 divided by the desired mean.  (The parameter would be called &quot;lambda&quot;, but that is a reserved word in Python.)  Returned values range from 0 to positive infinity.
    #     gammavariate(alpha, beta) - Gamma distribution.  Not the gamma function!  Conditions on the parameters are alpha &gt; 0 and beta &gt; 0.
    #     gauss(mu, sigma) - Gaussian distribution.  mu is the mean, and sigma is the standard deviation.  This is slightly faster than the normalvariate() function.
    #     lognormvariate(mu, sigma) - Log normal distribution.  If you take the natural logarithm of this distribution, you'll get a normal distribution with mean mu and standard deviation sigma.  mu can have any value, and sigma must be greater than zero.
    #     normalvariate(mu, sigma) - Normal distribution.  mu is the mean, and sigma is the standard deviation.
    #     paretovariate(alpha) - Pareto distribution.  alpha is the shape parameter.
    #     random(...) random() -&gt; x in the interval [0, 1).
    #     vonmisesvariate(mu, kappa) - Circular data distribution.  mu is the mean angle, expressed in radians between 0 and 2*pi, and kappa is the concentration parameter, which must be greater than or equal to zero.  If kappa is equal to zero, this distribution reduces to a uniform random angle over the range 0 to 2*pi.
    #     weibullvariate(alpha, beta) - Weibull distribution.  alpha is the scale parameter and beta is the shape parameter.
    # 'samples' is the number of samples taken from the distribution
    [rstage]
    type=montecarlo
    distribution=uniform(50, 1000000)
    samples=100

</PRE>
<p>

<H2><A NAME="2.2.">2.2. Templates</A></H2>
All files in the 'template_path' directory will be processed by replacing each instance of 'keyword' 'any valid Python statement containing the variables in pyslice.conf' 'keyword'.  The keyword string and variable names are specified in pyslice.conf.
<p>
An example template file,

<PRE>
     T1 Simulation of salinity in the No Name River
     T2 with flow = $$flow$$
     # Any valid Python statement can be used
     F1 $$'%10.3f' % flow$$
     F2 46.58 $$'%10.3f' % (flow * 100)$$
     F3 $$flow$$ 35.679 $$'%d' % flow$$
</PRE>
<p>
with the example 'pyslice.conf' file above, would result in the following file in the output_path/00000 directory if the flat_dirs option is set, otherwise an entire directory tree is created that incorporates the variable names and the values:

<PRE>
     T1 Simulation of salinity in the No Name River
     T2 with flow = 90
     # Any valid Python statement can be used
     F1     90.000
     F2 46.58   9000.000
     F3 90 35.679 90
</PRE>
<p>
and the next directory in output_path:

<PRE>
     T1 Simulation of salinity in the No Name River
     T2 with flow = 92
     # Any valid Python statement can be used
     F1     92.000
     F2 46.58   9200.000
     F3 92 35.679 92
</PRE>
<p>
...etc.
<p>
<TABLE BORDER CELLSPACING=2 CELLPADDING=2><CAPTION ALIGN="TOP"> Table of example code in template files, 'flow' varies from 1 to 3 by 1 and 'water_level' varies from 9 to 12 by 1.</CAPTION >
<TR><TD VALIGN="TOP" ><B>Template Code </B></TD><TD VALIGN="TOP" ><B>Output Directory </B></TD><TD VALIGN="TOP" ><B>Flow Result </B></TD><TD VALIGN="TOP" ><B>Water Level Result </B></TD></TR>
<TR><TD VALIGN="TOP" >$$'%10.4f' % flow$$<BR>$$water_level$$</TD><TD VALIGN="TOP" >00000</TD><TD VALIGN="TOP" >1.0000</TD><TD VALIGN="TOP" >9</TD></TR>
<TR><TD VALIGN="TOP" ></TD><TD VALIGN="TOP" >00001</TD><TD VALIGN="TOP" >1.0000</TD><TD VALIGN="TOP" >10</TD></TR>
<TR><TD VALIGN="TOP" ></TD><TD VALIGN="TOP" >00002</TD><TD VALIGN="TOP" >1.0000</TD><TD VALIGN="TOP" >11</TD></TR>
<TR><TD VALIGN="TOP" ></TD><TD VALIGN="TOP" >00003</TD><TD VALIGN="TOP" >2.0000</TD><TD VALIGN="TOP" >9</TD></TR>
<TR><TD VALIGN="TOP" ></TD><TD VALIGN="TOP" >00004</TD><TD VALIGN="TOP" >2.0000</TD><TD VALIGN="TOP" >10</TD></TR>
<TR><TD VALIGN="TOP" ></TD><TD VALIGN="TOP" >00005</TD><TD VALIGN="TOP" >2.0000</TD><TD VALIGN="TOP" >11</TD></TR>
<TR><TD VALIGN="TOP" >$$'%10.4f' % (flow * 0.1)$$<BR>$$(water_level * 0.2)$$</TD><TD VALIGN="TOP" >00000</TD><TD VALIGN="TOP" >0.1000</TD><TD VALIGN="TOP" >1.8</TD></TR>
<TR><TD VALIGN="TOP" ></TD><TD VALIGN="TOP" >00001</TD><TD VALIGN="TOP" >0.1000</TD><TD VALIGN="TOP" >2.0</TD></TR>
<TR><TD VALIGN="TOP" ></TD><TD VALIGN="TOP" >00002</TD><TD VALIGN="TOP" >0.1000</TD><TD VALIGN="TOP" >2.2</TD></TR>
<TR><TD VALIGN="TOP" ></TD><TD VALIGN="TOP" >00003</TD><TD VALIGN="TOP" >0.2000</TD><TD VALIGN="TOP" >1.8</TD></TR>
<TR><TD VALIGN="TOP" ></TD><TD VALIGN="TOP" >00004</TD><TD VALIGN="TOP" >0.2000</TD><TD VALIGN="TOP" >2.0</TD></TR>
<TR><TD VALIGN="TOP" ></TD><TD VALIGN="TOP" >00005</TD><TD VALIGN="TOP" >0.2000</TD><TD VALIGN="TOP" >2.2</TD></TR>
</TABLE>
<p>

<H2><A NAME="2.3.">2.3. Tips and Tricks</A></H2>
If you want a model data set with a constant value, just manipulate the start and end values.
If you want several repetitions of the entire parameterization create a false variable that isn't used in any of the templates.  This would be useful if the model imposes some random behavoir that you want to study.
Another solution to obtain multiple repetitions is rerun pyslice with different output directories.
<p>

<H1><A NAME="3.">3. Mini Python Reference</A></H1>

<H2><A NAME="3.1.">3.1. Format</A></H2>
Python controls the format of a number through the following syntax:
<p>
<TT>'format_string' % number</TT>
<p>
If you want to make a calculation you must enclose the calculation in '()'.
<p>
Python number formatting is illustrated in the following table:
<TABLE BORDER CELLSPACING=2 CELLPADDING=2><CAPTION ALIGN="TOP"> Table of Python format strings</CAPTION >
<TR><TD VALIGN="TOP" ><B>Format </B></TD><TD VALIGN="TOP" ><B>Format String </B></TD><TD VALIGN="TOP" ><B>Definition </B></TD><TD VALIGN="TOP" ><B>Example </B></TD><TD VALIGN="TOP" ><B>Result </B></TD></TR>
<TR><TD VALIGN="TOP" >Floating point</TD><TD VALIGN="TOP" ><TT>'%m.nf'</TT></TD><TD VALIGN="TOP" >m=total width<BR>n=places after decimal</TD><TD VALIGN="TOP" ><TT>'%10.3f' % 12.2</TT></TD><TD VALIGN="TOP" ><TT>&nbsp;&nbsp;&nbsp;&nbsp;12.200</TT></TD></TR>
<TR><TD VALIGN="TOP" >Integer</TD><TD VALIGN="TOP" ><TT>'%md'</TT></TD><TD VALIGN="TOP" >m=total width</TD><TD VALIGN="TOP" ><TT>'%10d' % 12.2</TT></TD><TD VALIGN="TOP" ><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12</TT></TD></TR>
</TABLE>
<p>

<H1><A NAME="4.">4. Users Manual Disclaimer</A></H1>
I have manual writers block.  Frankly if anyone can figure out how to operate pyslice from this manual, they are smarter than I am.  :-)  I really want suggestions about how to make this clearer.  Send me a note!
</TD>
<TD VALIGN="TOP" WIDTH=100></TD>
</TR>
<TR>
<TD VALIGN="TOP" WIDTH=100>&nbsp;</TD>
<TD VALIGN="TOP" WIDTH=600><HR>Creator: <A HREF="mailto:timcera@earthlink.net">Tim Cera</A><BR>Updated/Created: 2005-03-06<BR><A HREF="http://home.earthlink.net/~timcera">Tim Cera's home page at http://home.earthlink.net/~timcera</A></TD>
<TD VALIGN="TOP" WIDTH=100>&nbsp;</TD>
</TR>
</TABLE>
</BODY>
</HTML>
